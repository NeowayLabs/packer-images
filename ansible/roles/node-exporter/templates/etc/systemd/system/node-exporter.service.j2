# updated at 2017-09-17T18:39:08Z

[Unit]
Description=Exporter for machine metrics http://prometheus.io/
Documentation=https://github.com/prometheus/node_exporter
After=systemd-networkd.service
Requires=systemd-networkd.service

[Service]
# Resource limits
CPUShares=512
MemoryLimit=1G
Restart=always
RestartSec=10
KillMode=mixed
User=root
ExecStartPre=/bin/mkdir -p /opt/bin
ExecStartPre=/usr/bin/wget -N -P /tmp https://github.com/prometheus/node_exporter/releases/download/v{{ node_exporter_version }}/node_exporter-{{ node_exporter_version }}.linux-amd64.tar.gz
ExecStartPre=/bin/tar \
    --strip-components 1 \
    -xf /tmp/node_exporter-{{ node_exporter_version }}.linux-amd64.tar.gz \
    -C /opt/bin node_exporter-{{ node_exporter_version }}.linux-amd64/node_exporter
ExecStartPre=/bin/chmod +x /opt/bin/node_exporter
ExecStart=/opt/bin/node_exporter
ExecStartPost=/bin/rm /tmp/node_exporter-{{ node_exporter_version }}.linux-amd64.tar.gz

[Install]
WantedBy=multi-user.target
